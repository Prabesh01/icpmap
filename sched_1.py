# day time room / teacher [empty for x minutes. empty in y minutes]
# day. section --> classes w/ holidays [plus google calander webs serv with holidays]
# save section selection in session. so user dont have to select each time. 
# https://developers.google.com/calendar/api/guides/create-events

import openpyxl
from datetime import datetime, timedelta

def read_xlsx():

    dataframe = openpyxl.load_workbook("Schedule.xlsx") # /home/prabesh/Downloads/Class 
    
    classes={}
    rooms=[]
    teachers=[]

    for sheet in dataframe.sheetnames:
        dataframe1=dataframe[sheet]
        cont=False
        for row in range(0, dataframe1.max_row):
            i=0
            individual_class={"class":sheet}
            day=None
            for col in dataframe1.iter_cols(1, dataframe1.max_column):
                val=col[row].value
                if val=="SUN":cont=True
                if not cont: continue
                tim=teach=room=None
                if i==0: day=val
                elif i==1: tim=val
                elif i==8: teach=val
                # elif i==9: individual_class["class"]=sheet+str(val)
                elif i==11: room=val
                if not day in classes: classes[day]=[]
                elif tim:
                    individual_class["stime"],individual_class["etime"]=tim.split(' - ') # ['08:30 AM', '10:00 AM']
                elif teach:
                    if not teach in teachers: teachers.append(teach)
                    individual_class["teacher"]=teach
                elif room:
                    if not room in rooms: rooms.append(room)
                    individual_class["room"]=room
                    classes[day].append(individual_class) 
                i+=1
    print(classes)

# read_xlsx()
classes={'SUN': [{'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Kiran Kunwar', 'room': 'TR03- Thames'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Ms. Sajena Dwa', 'room': 'TR03- Thames'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Ashish Subedi', 'room': 'TR01- Bigben'}, {'stime': '11:00 AM', 'etime': '12:30 PM', 'teacher': 'Mr. Arjun Sapkota', 'room': 'TR03- Thames'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Ms. Sajena Dwa', 'room': 'SR02- Begnas'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Arjun Sapkota', 'room': 'SR02- Begnas'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Anil Rai', 'room': 'TR02- Stonehenge'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Jeevan Pahari', 'room': 'TR02- Stonehenge'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Sushil Paudel', 'room': 'LT02- Annapurna'}, {'stime': '10:30 AM', 'etime': '12:00 PM', 'teacher': 'Mr. Sushil Paudel', 'room': 'TR01- Bigben'}, {'stime': '11:00 AM', 'etime': '12:30 PM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'LT01- Machhapuchhre'}, {'stime': '01:00 PM', 'etime': '02:30 PM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'LT02- Annapurna'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Sushil Paudel', 'room': 'LT02- Annapurna'}, {'stime': '07:30 AM', 'etime': '09:00 AM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'LT01- Machhapuchhre'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Mr. Sandip Dhakal', 'room': 'LT01- Machhapuchhre'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Amar Khanal', 'room': 'LT02- Annapurna'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Amar Khanal', 'room': 'LT02- Annapurna'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Sandip Dhakal', 'room': 'LT01- Machhapuchhre'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Ms. Pratibha Gurung', 'room': 'SR01- Fewa'}, {'stime': '07:30 AM', 'etime': '09:00 AM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'SR03- Rara'}, {'stime': '09:00 AM', 'etime': '10:30 AM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'SR03- Rara'}, {'stime': '09:00 AM', 'etime': '10:30 AM', 'teacher': 'Mr. Midhir Rana', 'room': 'Lab02- Nilgiri'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Ms. Pratibha Gurung', 'room': 'SR02- Begnas'}, {'stime': '10:30 AM', 'etime': '12:00 PM', 'teacher': 'Mr. Sandip Adhikari', 'room': 'SR04- Tilicho'}, {'stime': '11:00 AM', 'etime': '12:30 PM', 'teacher': 'Mr. Midhir Rana', 'room': 'TR02- Stonehenge'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'SR02- Begnas'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Achyut Parajuli', 'room': 'SR03- Rara'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Sunil Thapa', 'room': 'Lab01- Gokyo'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Ms. Pratibha Gurung', 'room': 'Lab02- Nilgiri'}, {'stime': '12:30 PM', 'etime': '02:00 PM', 'teacher': 'Mr. Midhir Rana', 'room': 'SR04- Tilicho'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'SR01- Fewa'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Sandip Adhikari', 'room': 'SR02- Begnas'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Sunil Thapa', 'room': 'SR03- Rara'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Prasant Adhikari', 'room': 'Lab02- Nilgiri'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Mahesh Dhungana ', 'room': 'SR04- Tilicho'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Nabaraj Adhikari', 'room': 'Lab01- Gokyo'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Mahesh Dhungana ', 'room': 'SR04- Tilicho'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Nabaraj Adhikari', 'room': 'Lab01- Gokyo'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Nabaraj Adhikari', 'room': 'SR01- Fewa'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Mahesh Dhungana ', 'room': 'Lab01- Gokyo'}], 'MON': [{'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Mr. Ashish Subedi', 'room': 'Lab 03- Open Access Lab'}, {'stime': '12:00 PM', 'etime': '01:30 PM', 'teacher': 'Mr. Arjun Sapkota', 'room': 'SR01- Fewa'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Ms. Sajena Dwa', 'room': 'TR01- Bigben'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Kiran Kunwar', 'room': 'TR01- Bigben'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Kiran Kunwar', 'room': 'SR01- Fewa'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Jeevan Pahari', 'room': 'SR01- Fewa'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Ashish Subedi', 'room': 'TR03- Thames'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Vikram Rana', 'room': 'TR03- Thames'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Amar Khanal', 'room': 'LT01- Machhapuchhre'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Sandip Dhakal', 'room': 'SR03- Rara'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Sandip Dhakal', 'room': 'LT01- Machhapuchhre'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Amar Khanal', 'room': 'LT02- Annapurna'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Sushil Paudel', 'room': 'LT01- Machhapuchhre'}, {'stime': '07:30 AM', 'etime': '09:00 AM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'LT02- Annapurna'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Sushil Paudel', 'room': 'LT01- Machhapuchhre'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Mr. Sandip Dhakal', 'room': 'LT02- Annapurna'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Amar Khanal', 'room': 'LT01- Machhapuchhre'}, {'stime': '11:00 AM', 'etime': '12:30 PM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'LT02- Annapurna'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Achyut Parajuli', 'room': 'SR04- Tilicho'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Ms. Pratibha Gurung', 'room': 'Lab01- Gokyo'}, {'stime': '08:00 AM', 'etime': '09:30 AM', 'teacher': 'Mr. Midhir Rana', 'room': 'SR02- Begnas'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Ms. Pratibha Gurung', 'room': 'Lab01- Gokyo'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'SR02- Begnas'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Mr. Midhir Rana', 'room': 'TR02- Stonehenge'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Achyut Parajuli', 'room': 'SR03- Rara'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Prasant Adhikari', 'room': 'TR03- Thames'}, {'stime': '10:30 AM', 'etime': '12:00 PM', 'teacher': 'Mr. Sandip Adhikari', 'room': 'SR01- Fewa'}, {'stime': '10:30 AM', 'etime': '12:00 PM', 'teacher': 'Mr. Sunil Thapa', 'room': 'Lab02- Nilgiri'}, {'stime': '11:00 AM', 'etime': '12:30 PM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'SR02- Begnas'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Midhir Rana', 'room': 'TR02- Stonehenge'}, {'stime': '12:30 PM', 'etime': '02:00 PM', 'teacher': 'Mr. Sandip Adhikari', 'room': 'Lab02- Nilgiri'}, {'stime': '12:30 PM', 'etime': '02:00 PM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'SR04- Tilicho'}, {'stime': '01:00 PM', 'etime': '02:30 PM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'SR03- Rara'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Sunil Thapa', 'room': 'SR02- Begnas'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Mahesh Dhungana ', 'room': 'SR03- Rara'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Mahesh Dhungana ', 'room': 'SR03- Rara'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Nabaraj Adhikari', 'room': 'SR04- Tilicho'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Nabaraj Adhikari', 'room': 'SR04- Tilicho'}], 'TUE': [{'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Kiran Kunwar', 'room': 'Lab01- Gokyo'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Ms. Sajena Dwa', 'room': 'Meeting Room'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Mr. Ashish Subedi', 'room': 'Lab02- Nilgiri'}, {'stime': '12:00 PM', 'etime': '01:30 PM', 'teacher': 'Mr. Arjun Sapkota', 'room': 'LT02- Annapurna'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Ms. Sajena Dwa', 'room': 'SR01- Fewa'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Arjun Sapkota', 'room': 'SR01- Fewa'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Anil Rai', 'room': 'TR03- Thames'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Jeevan Pahari', 'room': 'TR03- Thames'}, {'stime': '09:00 AM', 'etime': '10:30 AM', 'teacher': 'Mr. Krishna Wagle', 'room': 'LT02- Annapurna'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Achyut Parajuli', 'room': 'SR01- Fewa'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Ashish Lamichhane', 'room': 'TR02- Stonehenge'}, {'stime': '12:00 PM', 'etime': '01:30 PM', 'teacher': 'Mr. Idu Nepali', 'room': 'Lab 03- Open Access Lab'}, {'stime': '01:00 PM', 'etime': '02:30 PM', 'teacher': 'Mr. Ashish Lamichhane', 'room': 'TR02- Stonehenge'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Achyut Parajuli', 'room': 'TR01- Bigben'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Idu Nepali', 'room': 'Lab 03- Open Access Lab'}, {'stime': '03:00 PM', 'etime': '04:30 PM', 'teacher': 'Mr. Krishna Wagle', 'room': 'SR04- Tilicho'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Ashish Lamichhane', 'room': 'Lab02- Nilgiri'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Amar Khanal', 'room': 'TR01- Bigben'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'TR02- Stonehenge'}, {'stime': '09:00 AM', 'etime': '10:30 AM', 'teacher': 'Mr. Subash Sapkota Hamal', 'room': 'SR04- Tilicho'}, {'stime': '09:00 AM', 'etime': '10:30 AM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'Lab01- Gokyo'}, {'stime': '09:00 AM', 'etime': '10:30 AM', 'teacher': 'Mr. Idu Nepali', 'room': 'Lab 03- Open Access Lab'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Mr. Sandip Dhakal', 'room': 'TR02- Stonehenge'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Ashish Lamichhane', 'room': 'SR01- Fewa'}, {'stime': '10:30 AM', 'etime': '12:00 PM', 'teacher': 'Mr. Subash Sapkota Hamal', 'room': 'LT02- Annapurna'}, {'stime': '10:30 AM', 'etime': '12:00 PM', 'teacher': 'Mr. Amar Khanal', 'room': 'Lab01- Gokyo'}, {'stime': '10:30 AM', 'etime': '12:00 PM', 'teacher': 'Mr. Krishna Wagle', 'room': 'Lab 03- Open Access Lab'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Sandip Dhakal', 'room': 'Lab02- Nilgiri'}, {'stime': '12:00 PM', 'etime': '01:30 PM', 'teacher': 'Mr. Amar Khanal', 'room': 'Lab01- Gokyo'}, {'stime': '12:00 PM', 'etime': '01:30 PM', 'teacher': 'Mr. Krishna Wagle', 'room': 'TR01- Bigben'}, {'stime': '01:00 PM', 'etime': '02:30 PM', 'teacher': 'Mr. Subash Sapkota Hamal', 'room': 'Lab02- Nilgiri'}, {'stime': '01:00 PM', 'etime': '02:30 PM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'SR03- Rara'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Amar Khanal', 'room': 'Lab01- Gokyo'}, {'stime': '02:30 PM', 'etime': '04:00 PM', 'teacher': 'Mr. Subash Sapkota Hamal', 'room': 'Lab02- Nilgiri'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'SR02- Begnas'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Prasant Adhikari', 'room': 'SR03- Rara'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Ms. Pratibha Gurung', 'room': 'SR04- Tilicho'}, {'stime': '07:30 AM', 'etime': '09:00 AM', 'teacher': 'Mr. Midhir Rana', 'room': 'Lab 03- Open Access Lab'}, {'stime': '09:00 AM', 'etime': '10:30 AM', 'teacher': 'Ms. Pratibha Gurung', 'room': 'SR03- Rara'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'SR02- Begnas'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Mr. Achyut Parajuli', 'room': 'TR01- Bigben'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Sunil Thapa', 'room': 'LT01- Machhapuchhre'}, {'stime': '10:30 AM', 'etime': '12:00 PM', 'teacher': 'Mr. Sandip Adhikari', 'room': 'SR04- Tilicho'}, {'stime': '11:00 AM', 'etime': '12:30 PM', 'teacher': 'Mr. Midhir Rana', 'room': 'TR03- Thames'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'SR02- Begnas'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Ms. Pratibha Gurung', 'room': 'SR03- Rara'}, {'stime': '12:30 PM', 'etime': '02:00 PM', 'teacher': 'Mr. Midhir Rana', 'room': 'SR04- Tilicho'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'SR01- Fewa'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Sandip Adhikari', 'room': 'SR02- Begnas'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Sunil Thapa', 'room': 'TR03- Thames'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Mahesh Dhungana ', 'room': 'LT01- Machhapuchhre'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Nabaraj Adhikari', 'room': 'LT02- Annapurna'}], 'WED': [{'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Ashish Subedi', 'room': 'Lab 03- Open Access Lab'}, {'stime': '11:00 AM', 'etime': '12:30 PM', 'teacher': 'Mr. Arjun Sapkota', 'room': 'Lab02- Nilgiri'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Ms. Sajena Dwa', 'room': 'TR03- Thames'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Kiran Kunwar', 'room': 'TR03- Thames'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Kiran Kunwar', 'room': 'SR02- Begnas'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Jeevan Pahari ', 'room': 'SR02- Begnas'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Ashish Subedi', 'room': 'TR02- Stonehenge'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Vikram Rana', 'room': 'TR02- Stonehenge'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Idu Nepali', 'room': 'Lab 03- Open Access Lab'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Mr. Krishna Wagle', 'room': 'LT01- Machhapuchhre'}, {'stime': '11:00 AM', 'etime': '12:30 PM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'LT01- Machhapuchhre'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Achyut Parajuli', 'room': 'LT02- Annapurna'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Idu Nepali', 'room': 'Lab 03- Open Access Lab'}, {'stime': '01:00 PM', 'etime': '02:30 PM', 'teacher': 'Mr. Krishna Wagle', 'room': 'TR01- Bigben'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Achyut Parajuli', 'room': 'SR01- Fewa'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'Lab01- Gokyo'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Sandip Dhakal', 'room': 'Lab01- Gokyo'}, {'stime': '07:30 AM', 'etime': '09:00 AM', 'teacher': 'Mr. Ashish Lamichhane', 'room': 'Lab02- Nilgiri'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Amar Khanal', 'room': 'SR04- Tilicho'}, {'stime': '09:00 AM', 'etime': '10:30 AM', 'teacher': 'Mr. Subash Sapkota Hamal', 'room': 'Lab02- Nilgiri'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Amar Khanal', 'room': 'TR03- Thames'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Idu Nepali', 'room': 'Lab 03- Open Access Lab'}, {'stime': '10:30 AM', 'etime': '12:00 PM', 'teacher': 'Mr. Ashish Lamichhane', 'room': 'SR03- Rara'}, {'stime': '10:30 AM', 'etime': '12:00 PM', 'teacher': 'Mr. Subash Sapkota Hamal', 'room': 'Lab01- Gokyo'}, {'stime': '10:30 AM', 'etime': '12:00 PM', 'teacher': 'Mr. Sandip Dhakal', 'room': 'TR02- Stonehenge'}, {'stime': '11:00 AM', 'etime': '12:30 PM', 'teacher': 'Mr. Krishna Wagle', 'room': 'TR01- Bigben'}, {'stime': '12:00 PM', 'etime': '01:30 PM', 'teacher': 'Mr. Ashish Lamichhane', 'room': 'SR02- Begnas'}, {'stime': '12:00 PM', 'etime': '01:30 PM', 'teacher': 'Mr. Abhinav Dahal', 'room': 'TR02- Stonehenge'}, {'stime': '12:30 PM', 'etime': '02:00 PM', 'teacher': 'Mr. Subash Sapkota Hamal', 'room': 'SR04- Tilicho'}, {'stime': '01:00 PM', 'etime': '02:30 PM', 'teacher': 'Mr. Sandip Dhakal', 'room': 'TR03- Thames'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Ashish Lamichhane', 'room': 'SR02- Begnas'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Idu Nepali', 'room': 'Lab 03- Open Access Lab'}, {'stime': '02:30 PM', 'etime': '04:00 PM', 'teacher': 'Mr. Krishna Wagle', 'room': 'TR02- Stonehenge'}, {'stime': '03:30 PM', 'etime': '05:00 PM', 'teacher': 'Mr. Subash Sapkota Hamal', 'room': 'SR04- Tilicho'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Midhir Rana', 'room': 'SR01- Fewa'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Ms. Pratibha Gurung', 'room': 'SR03- Rara'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'SR04- Tilicho'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Achyut Parajuli', 'room': 'TR01- Bigben'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Midhir Rana', 'room': 'LT02- Annapurna'}, {'stime': '09:00 AM', 'etime': '10:30 AM', 'teacher': 'Ms. Pratibha Gurung', 'room': 'SR01- Fewa'}, {'stime': '09:00 AM', 'etime': '10:30 AM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'SR03- Rara'}, {'stime': '09:00 AM', 'etime': '10:30 AM', 'teacher': 'Mr. Sandip Adhikari', 'room': 'Lab01- Gokyo'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'TR01- Bigben'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Midhir Rana', 'room': 'LT02- Annapurna'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Achyut Parajuli', 'room': 'SR02- Begnas'}, {'stime': '10:30 AM', 'etime': '12:00 PM', 'teacher': 'Mr. Sunil Thapa', 'room': 'SR01- Fewa'}, {'stime': '10:30 AM', 'etime': '12:00 PM', 'teacher': 'Mr. Prasant Adhikari', 'room': 'SR04- Tilicho'}, {'stime': '12:00 PM', 'etime': '01:30 PM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'Lab01- Gokyo'}, {'stime': '12:30 PM', 'etime': '02:00 PM', 'teacher': 'Mr. Sunil Thapa', 'room': 'Lab02- Nilgiri'}, {'stime': '01:00 PM', 'etime': '02:30 PM', 'teacher': 'Mr. Sandip Adhikari', 'room': 'SR03- Rara'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Mahesh Dhungana ', 'room': 'LT01- Machhapuchhre'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Nabaraj Adhikari', 'room': 'LT02- Annapurna'}], 'THU': [{'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Kiran Kunwar', 'room': 'TR01- Bigben'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Ms. Sajena Dwa', 'room': 'TR02- Stonehenge'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Ashish Subedi', 'room': 'Lab02- Nilgiri'}, {'stime': '11:00 AM', 'etime': '12:30 PM', 'teacher': 'Mr. Arjun Sapkota', 'room': 'SR02- Begnas'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Ms. Sajena Dwa', 'room': 'SR01- Fewa'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Arjun Sapkota', 'room': 'SR01- Fewa'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Anil Rai', 'room': 'TR03- Thames'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Jeevan Pahari', 'room': 'TR03- Thames'}, {'stime': '07:30 AM', 'etime': '09:00 AM', 'teacher': 'Mr. Ashish Lamichhane', 'room': 'SR02- Begnas'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Achyut Parajuli', 'room': 'Lab02- Nilgiri'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Krishna Wagle', 'room': 'TR02- Stonehenge'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Idu Nepali', 'room': 'Lab 03- Open Access Lab'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Ashish Lamichhane', 'room': 'TR01- Bigben'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Achyut Parajuli', 'room': 'TR03- Thames'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Idu Nepali', 'room': 'Lab 03- Open Access Lab'}, {'stime': '03:30 PM', 'etime': '05:00 PM', 'teacher': 'Mr. Krishna Wagle', 'room': 'SR04- Tilicho'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'SR03- Rara'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Amar Khanal', 'room': 'Lab 03- Open Access Lab'}, {'stime': '07:30 AM', 'etime': '09:00 AM', 'teacher': 'Mr. Sandip Dhakal', 'room': 'TR02- Stonehenge'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Amar Khanal', 'room': 'Lab 03- Open Access Lab'}, {'stime': '09:00 AM', 'etime': '10:30 AM', 'teacher': 'Mr. Subash Sapkota Hamal', 'room': 'SR03- Rara'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Mr. Sandip Dhakal', 'room': 'SR02- Begnas'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'SR01- Fewa'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Krishna Wagle', 'room': 'TR03- Thames'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Idu Nepali', 'room': 'Lab 03- Open Access Lab'}, {'stime': '10:30 AM', 'etime': '12:00 PM', 'teacher': 'Mr. Ashish Lamichhane', 'room': 'TR01- Bigben'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Amar Khanal', 'room': 'SR04- Tilicho'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Subash Sapkota Hamal', 'room': 'Lab01- Gokyo'}, {'stime': '12:00 PM', 'etime': '01:30 PM', 'teacher': 'Mr. Ashish Lamichhane', 'room': 'TR01- Bigben'}, {'stime': '01:00 PM', 'etime': '02:30 PM', 'teacher': 'Mr. Subash Sapkota Hamal', 'room': 'Lab01- Gokyo'}, {'stime': '01:00 PM', 'etime': '02:30 PM', 'teacher': 'Mr. Krishna Wagle', 'room': 'TR02- Stonehenge'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'SR04- Tilicho'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Amar Khanal', 'room': 'Lab02- Nilgiri'}, {'stime': '03:00 PM', 'etime': '04:30 PM', 'teacher': 'Mr. Subash Sapkota Hamal', 'room': 'Lab01- Gokyo'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Ms. Pratibha Gurung', 'room': 'LT01- Machhapuchhre'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Prasant Adhikari', 'room': 'LT02- Annapurna'}, {'stime': '09:00 AM', 'etime': '10:30 AM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'LT01- Machhapuchhre'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Mr. Sandip Adhikari', 'room': 'LT02- Annapurna'}, {'stime': '10:30 AM', 'etime': '12:00 PM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'LT01- Machhapuchhre'}, {'stime': '01:00 PM', 'etime': '02:30 PM', 'teacher': 'Mr. Prasant Adhikari', 'room': 'LT01- Machhapuchhre'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Mahesh Dhungana ', 'room': 'SR04- Tilicho'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Nabaraj Adhikari', 'room': 'Lab01- Gokyo'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Mahesh Dhungana ', 'room': 'SR04- Tilicho'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Nabaraj Adhikari', 'room': 'Lab01- Gokyo'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Mahesh Dhungana ', 'room': 'Lab01- Gokyo'}], 'FRI': [{'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Ashish Subedi', 'room': 'Lab02- Nilgiri'}, {'stime': '11:00 AM', 'etime': '12:30 PM', 'teacher': 'Mr. Arjun Sapkota', 'room': 'TR01- Bigben'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Ms. Sajena Dwa', 'room': 'SR02- Begnas'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Kiran Kunwar', 'room': 'SR02- Begnas'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Kiran Kunwar', 'room': 'SR03- Rara'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Jeevan Pahari', 'room': 'SR03- Rara'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Ashish Subedi', 'room': 'TR03- Thames'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Vikram Rana', 'room': 'TR03- Thames'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Idu Nepali', 'room': 'Lab 03- Open Access Lab'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'SR04- Tilicho'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Achyut Parajuli', 'room': 'TR03- Thames'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Krishna Wagle', 'room': 'TR02- Stonehenge'}, {'stime': '12:30 PM', 'etime': '02:00 PM', 'teacher': 'Mr. Mission Babu Sapkota', 'room': 'TR01- Bigben'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Achyut Parajuli', 'room': 'Lab02- Nilgiri'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Idu Nepali', 'room': 'Lab 03- Open Access Lab'}, {'stime': '03:00 PM', 'etime': '04:30 PM', 'teacher': 'Mr. Krishna Wagle', 'room': 'Lab01- Gokyo'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Ashish Lamichhane', 'room': 'Lab02- Nilgiri'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Amar Khanal', 'room': 'TR01- Bigben'}, {'stime': '07:30 AM', 'etime': '09:00 AM', 'teacher': 'Mr. Sandip Dhakal', 'room': 'SR01- Fewa'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Amar Khanal', 'room': 'Lab 03- Open Access Lab'}, {'stime': '09:00 AM', 'etime': '10:30 AM', 'teacher': 'Mr. Subash Sapkota Hamal', 'room': 'SR01- Fewa'}, {'stime': '09:00 AM', 'etime': '10:30 AM', 'teacher': 'Mr. Idu Nepali', 'room': 'TR01- Bigben'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Mr. Krishna Wagle', 'room': 'TR02- Stonehenge'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Ashish Lamichhane', 'room': 'SR03- Rara'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Sandip Dhakal', 'room': 'Lab02- Nilgiri'}, {'stime': '10:30 AM', 'etime': '12:00 PM', 'teacher': 'Mr. Subash Sapkota Hamal', 'room': 'SR01- Fewa'}, {'stime': '11:00 AM', 'etime': '12:30 PM', 'teacher': 'Mr. Abhinav Dahal', 'room': 'SR02- Begnas'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Ashish Lamichhane', 'room': 'SR03- Rara'}, {'stime': '11:30 AM', 'etime': '01:00 PM', 'teacher': 'Mr. Idu Nepali', 'room': 'Lab 03- Open Access Lab'}, {'stime': '12:00 PM', 'etime': '01:30 PM', 'teacher': 'Mr. Sandip Dhakal', 'room': 'Lab01- Gokyo'}, {'stime': '12:30 PM', 'etime': '02:00 PM', 'teacher': 'Mr. Subash Sapkota Hamal', 'room': 'TR03- Thames'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Ashish Lamichhane', 'room': 'SR03- Rara'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Mr. Krishna Wagle', 'room': 'Lab01- Gokyo'}, {'stime': '02:00 PM', 'etime': '03:30 PM', 'teacher': 'Mr. Subash Sapkota Hamal', 'room': 'TR03- Thames'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Ms. Pratibha Gurung', 'room': 'LT02- Annapurna'}, {'stime': '09:00 AM', 'etime': '10:30 AM', 'teacher': 'Mr. Sandeep Gurung', 'room': 'LT01- Machhapuchhre'}, {'stime': '09:30 AM', 'etime': '11:00 AM', 'teacher': 'Mr. Sandip Adhikari', 'room': 'LT02- Annapurna'}, {'stime': '11:00 AM', 'etime': '12:30 PM', 'teacher': 'Mr. Sandip Adhikari', 'room': 'LT01- Machhapuchhre'}, {'stime': '12:00 PM', 'etime': '01:30 PM', 'teacher': 'Mr. Prasant Adhikari', 'room': 'LT02- Annapurna'}, {'stime': '01:30 PM', 'etime': '03:00 PM', 'teacher': 'Ms. Pratibha Gurung', 'room': 'LT02- Annapurna'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Mahesh Dhungana ', 'room': 'SR04- Tilicho'}, {'stime': '07:00 AM', 'etime': '08:30 AM', 'teacher': 'Mr. Nabaraj Adhikari', 'room': 'Lab01- Gokyo'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Mahesh Dhungana ', 'room': 'SR04- Tilicho'}, {'stime': '08:30 AM', 'etime': '10:00 AM', 'teacher': 'Mr. Nabaraj Adhikari', 'room': 'Lab01- Gokyo'}, {'stime': '10:00 AM', 'etime': '11:30 AM', 'teacher': 'Mr. Nabaraj Adhikari', 'room': 'Lab01- Gokyo'}]}
teachers=['Mr. Kiran Kunwar', 'Ms. Sajena Dwa', 'Mr. Ashish Subedi', 'Mr. Arjun Sapkota', 'Mr. Jeevan Pahari', 'Mr. Jeevan Pahari ', 'Mr. Anil Rai', 'Mr. Vikram Rana', 'Mr. Sushil Paudel', 'Mr. Mission Babu Sapkota', 'Mr. Amar Khanal', 'Mr. Sandip Dhakal', 'Mr. Krishna Wagle', 'Mr. Achyut Parajuli', 'Mr. Ashish Lamichhane', 'Mr. Idu Nepali', 'Mr. Subash Sapkota Hamal', 'Mr. Abhinav Dahal', 'Ms. Pratibha Gurung', 'Mr. Sandeep Gurung', 'Mr. Midhir Rana', 'Mr. Sandip Adhikari', 'Mr. Sunil Thapa', 'Mr. Prasant Adhikari', 'Mr. Mahesh Dhungana ', 'Mr. Nabaraj Adhikari']
rooms=['TR03- Thames', 'Lab 03- Open Access Lab', 'SR01- Fewa', 'Lab01- Gokyo', 'Meeting Room', 'TR01- Bigben', 'TR02- Stonehenge', 'LT02- Annapurna', 'SR02- Begnas', 'SR03- Rara', 'LT01- Machhapuchhre', 'SR04- Tilicho', 'Lab02- Nilgiri']

def calculate_time_difference(reference_time, check_time):
  time_delta = timedelta(hours=abs(check_time.hour - reference_time.hour),
                         minutes=abs(check_time.minute - reference_time.minute),
                         seconds=abs(check_time.second - reference_time.second))

  return time_delta

weekdays=["SUN","MON","TUE","WED","THU","FRI","SAT"]
def empty(day=None,check_time=datetime.now().time(),teach=None):
    empty_rooms_list=rooms[:]
    taken_rooms_list={}
    empty_rooms={}
    taken_rooms={}
    if not day:day=weekdays[datetime.today().weekday()]
    for classe in classes[day]:
        start_time = datetime.strptime(classe["stime"], "%I:%M %p").time()
        end_time = datetime.strptime(classe["etime"], "%I:%M %p").time()
        # >= <= check ifi within range
        if (start_time <= check_time and check_time <= end_time):
            if classe["teacher"]==teach: return classe["room"],classe["etime"]
            empty_rooms_list.remove(classe["room"])
            taken_rooms_list[classe["room"]]=end_time
    if teach: return None

    for clase,etim in taken_rooms_list.items():
        # empty in y mins, find the end time. and check if the end time is start time for the same room. in loop
        etime=etim
        for i in range(3):
            for classez in classes[day]:
                if classez["room"]==clase:
                    start_time = datetime.strptime(classez["stime"], "%I:%M %p").time()
                    if start_time==etime: etime=datetime.strptime(classez["etime"], "%I:%M %p").time()
            taken_rooms[clase]=int(calculate_time_difference(etime,check_time).total_seconds()/60)

    for clase in empty_rooms_list:
        # empty for x minutes, find the next start time closest (gt) to given time
        closest=None 
        for classez in classes[day]:
            if classez["room"]==clase: 
                start_time = datetime.strptime(classez["stime"], "%I:%M %p").time()
                end_time = datetime.strptime(classez["etime"], "%I:%M %p").time()

                diff=calculate_time_difference(start_time,check_time).total_seconds()
                
                if start_time >= check_time: 
                    if closest:
                        if diff>closest: continue
                    closest=diff
                    empty_rooms[clase]=int(closest/60)
        if not clase in empty_rooms: empty_rooms[clase]=None

    print(empty_rooms)
    print(taken_rooms)

empty("SUN",datetime.strptime("07:49 AM", "%I:%M %p").time()) # "SUN",datetime.strptime("08:01 AM", "%I:%M %p").time())# ,"Mr. Sushil Paudel")

# day, time, room, teacher
{
    "sun":
 [
     {"stime":"","etime":"","room":"","teacher":""},

 ],
    "mon":
 [
    {"time":"","etime":"","room":"","teacher":""},

 ],
}